<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#17212b">
<title>Aviator - Nekros</title>
<style>
:root{
--tg-theme-bg-color:#17212b;
--tg-theme-secondary-bg-color:#232e3c;
--tg-theme-text-color:#f5f5f5;
--tg-theme-hint-color:#708499;
--tg-theme-link-color:#62bcf9;
--tg-theme-button-color:#5288c1;
--tg-theme-button-text-color:#ffffff;
--tg-theme-accent-text-color:#62bcf9;
--tg-theme-section-bg-color:#17212b;
--tg-theme-section-header-text-color:#62bcf9;
--tg-theme-subtitle-text-color:#708499;
--tg-theme-destructive-text-color:#ef5b5b;
--tg-success:#4ddb7c;
--tg-warning:#ffa940;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{
font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;
background:var(--tg-theme-bg-color);
color:var(--tg-theme-text-color);
overflow:hidden;
height:100vh;
display:flex;
flex-direction:column;
touch-action:manipulation;
}
@keyframes bg-animate{0%{background-position:100% 0%}100%{background-position:0% 100%}}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.6}}
@keyframes notif-in{0%{opacity:0;transform:translateY(-20px)scale(.95)}100%{opacity:1;transform:translateY(0)scale(1)}}
@keyframes notif-out{0%{opacity:1;transform:translateY(0)scale(1)}100%{opacity:0;transform:translateY(-20px)scale(.95)}}
.balance-bar{
background:var(--tg-theme-secondary-bg-color);
padding:10px 16px;
display:flex;
justify-content:center;
border-bottom:1px solid rgba(255,255,255,.08);
}
.balance-content{
display:flex;
align-items:center;
gap:8px;
background:rgba(77,219,124,.12);
padding:8px 16px;
border-radius:10px;
}
.balance-label{
font-size:12px;
color:var(--tg-theme-hint-color);
font-weight:500;
}
.balance-value{
font-size:18px;
font-weight:700;
color:var(--tg-success);
}
.history{
display:flex;
gap:6px;
padding:10px 16px;
background:var(--tg-theme-secondary-bg-color);
overflow-x:auto;
scrollbar-width:none;
-webkit-overflow-scrolling:touch;
border-bottom:1px solid rgba(255,255,255,.08);
}
.history::-webkit-scrollbar{display:none}
.h-item{
min-width:50px;
height:30px;
display:flex;
align-items:center;
justify-content:center;
border-radius:8px;
font-size:13px;
font-weight:600;
flex-shrink:0;
}
.h-low{background:rgba(239,91,91,.2);color:#ef5b5b}
.h-mid{background:rgba(255,169,64,.2);color:#ffa940}
.h-high{background:rgba(77,219,124,.2);color:#4ddb7c}
.game{
flex:1;
position:relative;
background:var(--tg-theme-bg-color);
display:flex;
align-items:center;
justify-content:center;
overflow:hidden;
}
.game::before{
content:'';
position:absolute;
inset:0;
background:repeating-linear-gradient(0deg,transparent,transparent 50px,rgba(98,188,249,.03)50px,rgba(98,188,249,.03)51px),
repeating-linear-gradient(90deg,transparent,transparent 50px,rgba(98,188,249,.03)50px,rgba(98,188,249,.03)51px);
opacity:.5;
pointer-events:none;
}
.game.flying::before{animation:bg-animate 3s linear infinite}
.multiplier{
position:absolute;
top:30%;
left:50%;
transform:translateX(-50%);
font-size:18vw;
font-weight:800;
color:var(--tg-success);
text-shadow:0 0 60px rgba(77,219,124,.4);
letter-spacing:-.04em;
z-index:10;
}
.plane{
position:absolute;
width:140px;
height:140px;
top:55%;
left:50%;
transform:translate(-50%,-50%);
z-index:5;
filter:drop-shadow(0 4px 20px rgba(98,188,249,.3));
}
#lottie{width:100%;height:100%}
.countdown{
position:absolute;
top:50%;
left:50%;
transform:translate(-50%,-50%);
font-size:30vw;
font-weight:900;
color:var(--tg-warning);
text-shadow:0 0 60px rgba(255,169,64,.5);
z-index:100;
}
.game.countdown-active .plane,.game.countdown-active .multiplier,.game.crashed .plane{display:none}
.crash-overlay{
position:absolute;
inset:0;
background:rgba(239,91,91,.15);
display:flex;
align-items:center;
justify-content:center;
font-size:14vw;
font-weight:900;
color:var(--tg-theme-destructive-text-color);
animation:pulse .8s ease-in-out;
z-index:15;
pointer-events:none;
backdrop-filter:blur(4px);
}
.controls{
background:var(--tg-theme-secondary-bg-color);
padding:12px 16px 16px;
border-top:1px solid rgba(255,255,255,.08);
}
.bet-section{
background:var(--tg-theme-bg-color);
border-radius:10px;
padding:10px;
margin-bottom:10px;
}
.bet-label{
font-size:12px;
color:var(--tg-theme-hint-color);
margin-bottom:6px;
font-weight:500;
}
.bet-input-wrapper{
position:relative;
display:flex;
align-items:center;
gap:6px;
}
.bet-input{
flex:1;
padding:12px 14px;
background:var(--tg-theme-secondary-bg-color);
border:1px solid rgba(98,188,249,.2);
border-radius:8px;
color:var(--tg-theme-text-color);
font-size:20px;
font-weight:700;
text-align:center;
-webkit-appearance:none;
transition:border-color .2s;
}
.bet-input:focus{
outline:none;
border-color:var(--tg-theme-link-color);
background:var(--tg-theme-bg-color);
}
.bet-input::-webkit-outer-spin-button,.bet-input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}
.bet-input[type=number]{-moz-appearance:textfield}
.bet-btn-small{
width:44px;
height:44px;
display:flex;
align-items:center;
justify-content:center;
background:var(--tg-theme-bg-color);
border:1px solid rgba(98,188,249,.2);
border-radius:8px;
color:var(--tg-theme-accent-text-color);
font-size:16px;
font-weight:700;
cursor:pointer;
transition:all .2s;
-webkit-tap-highlight-color:transparent;
user-select:none;
}
.bet-btn-small:active{transform:scale(.92);background:rgba(98,188,249,.15)}
.auto-section{
display:flex;
align-items:center;
gap:8px;
margin-top:6px;
padding:8px 10px;
background:var(--tg-theme-secondary-bg-color);
border-radius:8px;
}
.auto-label{
flex:1;
font-size:12px;
color:var(--tg-theme-hint-color);
}
.auto-input{
width:85px;
padding:6px 10px;
background:var(--tg-theme-bg-color);
border:1px solid rgba(98,188,249,.15);
border-radius:6px;
color:var(--tg-theme-text-color);
font-size:14px;
text-align:center;
}
.auto-input:focus{outline:none;border-color:var(--tg-theme-link-color)}
.main-btn{
width:100%;
padding:14px;
border:none;
border-radius:10px;
font-size:16px;
font-weight:600;
cursor:pointer;
transition:all .2s;
text-transform:none;
letter-spacing:-.2px;
}
.btn-bet{
background:var(--tg-theme-button-color);
color:var(--tg-theme-button-text-color);
box-shadow:0 2px 8px rgba(82,136,193,.3);
}
.btn-bet:active:not(:disabled){transform:scale(.97);box-shadow:0 1px 4px rgba(82,136,193,.2)}
.btn-cashout{
background:var(--tg-success);
color:#fff;
box-shadow:0 2px 8px rgba(77,219,124,.3);
}
.btn-cashout:active:not(:disabled){transform:scale(.97);box-shadow:0 1px 4px rgba(77,219,124,.2)}
.main-btn:disabled{opacity:.4;cursor:not-allowed}
.status{
text-align:center;
padding:6px;
font-size:11px;
color:var(--tg-theme-hint-color);
}
.hidden{display:none!important}
.bets{
position:absolute;
top:12px;
right:12px;
max-width:140px;
max-height:35vh;
overflow-y:auto;
background:rgba(35,46,60,.95);
backdrop-filter:blur(10px);
border-radius:12px;
padding:8px;
font-size:12px;
scrollbar-width:thin;
border:1px solid rgba(98,188,249,.15);
}
.bets::-webkit-scrollbar{width:4px}
.bets::-webkit-scrollbar-track{background:transparent}
.bets::-webkit-scrollbar-thumb{background:rgba(98,188,249,.3);border-radius:2px}
.bet-item{
padding:8px;
margin-bottom:6px;
background:rgba(98,188,249,.08);
border-radius:8px;
word-break:break-all;
}
.bet-win{background:rgba(77,219,124,.2);border:1px solid rgba(77,219,124,.3)}
.notification{
position:fixed;
top:16px;
left:50%;
transform:translateX(-50%);
background:var(--tg-theme-secondary-bg-color);
padding:16px 24px;
border-radius:12px;
font-size:15px;
font-weight:500;
text-align:center;
z-index:1000;
animation:notif-in .3s ease-out;
min-width:240px;
max-width:90vw;
box-shadow:0 4px 20px rgba(0,0,0,.3);
border:1px solid rgba(98,188,249,.2);
}
.notification.success{border-color:var(--tg-success);color:var(--tg-success)}
.notification.error{border-color:var(--tg-theme-destructive-text-color);color:var(--tg-theme-destructive-text-color)}
.notification.warning{border-color:var(--tg-warning);color:var(--tg-warning)}
.loading{
position:fixed;
inset:0;
background:var(--tg-theme-bg-color);
display:flex;
align-items:center;
justify-content:center;
z-index:999;
flex-direction:column;
gap:16px;
}
.spinner{
width:50px;
height:50px;
border:4px solid rgba(98,188,249,.2);
border-top-color:var(--tg-theme-link-color);
border-radius:50%;
animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>
<body>
<div class="loading" id="loading">
<div class="spinner"></div>
<div style="color:var(--tg-theme-hint-color);font-size:14px">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
</div>

<div class="balance-bar">
<div class="balance-content">
<span class="balance-label">–ë–∞–ª–∞–Ω—Å</span>
<span class="balance-value" id="bal">1000‚ÇΩ</span>
</div>
</div>

<div class="history" id="h"></div>

<div class="game" id="g">
<div class="multiplier" id="m">1.00x</div>
<div class="plane"><div id="lottie"></div></div>
<div class="countdown hidden" id="c"></div>
<div class="bets" id="b"></div>
</div>

<div class="controls">
<div class="bet-section">
<div class="bet-label">–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏</div>
<div class="bet-input-wrapper">
<button class="bet-btn-small" id="halfBtn" type="button">¬Ω</button>
<input type="number" class="bet-input" id="amt" value="100" min="10" max="10000" step="10" inputmode="numeric">
<button class="bet-btn-small" id="doubleBtn" type="button">2√ó</button>
</div>
<div class="auto-section">
<div class="auto-label">‚ö° –ê–≤—Ç–æ-–≤—ã–≤–æ–¥</div>
<input type="number" class="auto-input" id="auto" placeholder="2.00" min="1.01" step="0.1" inputmode="decimal">
</div>
</div>
<button class="main-btn btn-bet" id="betBtn" type="button">–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É</button>
<button class="main-btn btn-cashout hidden" id="cashBtn" type="button">–ó–∞–±—Ä–∞—Ç—å –≤—ã–∏–≥—Ä—ã—à</button>
<div class="status" id="s">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
<script>
'use strict';
(function(){
const WS_URL='https://nekros-aviator.onrender.com/ws';
const RETRY_DELAY=3000;
const NOTIF_DURATION=2500;
let ws,bal=1000,pid='P'+Math.random().toString(36).substr(2,8),bet_cur=null,hist=[],lottie_anim=null,reconnect_timer=null;
const $=id=>document.getElementById(id);

function init(){
try{
lottie_anim=lottie.loadAnimation({
container:$('lottie'),
renderer:'svg',
loop:true,
autoplay:true,
path:'./animations/plane.json',
rendererSettings:{preserveAspectRatio:'xMidYMid meet',progressiveLoad:true}
});
$('betBtn').addEventListener('click',bet);
$('cashBtn').addEventListener('click',cash);
$('halfBtn').addEventListener('click',()=>adj(.5));
$('doubleBtn').addEventListener('click',()=>adj(2));
lottie_anim.addEventListener('DOMLoaded',()=>{
$('loading').style.display='none';
});
}catch(e){
console.error('Lottie error:',e);
$('loading').innerHTML='<div style="color:var(--tg-theme-destructive-text-color)">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–Ω–∏–º–∞—Ü–∏–∏</div>';
}
connectWS();
}

function connectWS(){
try{
ws=new WebSocket(WS_URL);
ws.onopen=()=>{
$('s').textContent='üü¢ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ';
if(reconnect_timer){clearTimeout(reconnect_timer);reconnect_timer=null}
};
ws.onmessage=e=>{
try{
const d=JSON.parse(e.data);
switch(d.type){
case'status':upStatus(d.status);if(d.history)upHist(d.history);break;
case'countdown':showCD(d.seconds);break;
case'flying':startFly();break;
case'multiplier':upMult(d.value);break;
case'bet_placed':addBet(d);break;
case'cashout':handleCash(d);break;
case'crashed':handleCrash(d);break;
case'error':notif(d.message,'error');break;
}
}catch(err){console.error('Parse error:',err)}
};
ws.onerror=err=>{
console.error('WebSocket error:',err);
$('s').textContent='üî¥ –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è';
};
ws.onclose=()=>{
$('s').textContent='üü° –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...';
notif('–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–Ω–æ','warning');
if(!reconnect_timer){reconnect_timer=setTimeout(connectWS,RETRY_DELAY)}
};
}catch(e){
console.error('Connection error:',e);
$('s').textContent='üî¥ –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è';
reconnect_timer=setTimeout(connectWS,RETRY_DELAY);
}
}

function notif(msg,type='success'){
const n=document.createElement('div');
n.className='notification '+type;
n.textContent=msg;
document.body.appendChild(n);
setTimeout(()=>{
n.style.animation='notif-out .3s ease-in';
setTimeout(()=>n.remove(),300);
},NOTIF_DURATION);
}

function send(data){
if(ws&&ws.readyState===WebSocket.OPEN){
try{ws.send(JSON.stringify(data));return true}
catch(e){console.error('Send error:',e);notif('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏','error');return false}
}else{notif('–ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è','error');return false}
}

function bet(){
const amt=parseFloat($('amt').value);
const auto=$('auto').value?parseFloat($('auto').value):null;
if(isNaN(amt)||amt<10){notif('–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ 10‚ÇΩ','warning');return}
if(amt>10000){notif('–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ 10000‚ÇΩ','warning');return}
if(amt>bal){notif('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!','error');return}
if(auto&&(isNaN(auto)||auto<1.01)){notif('–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∞–≤—Ç–æ-–≤—ã–≤–æ–¥ 1.01x','warning');return}
if(send({type:'bet',player_id:pid,amount:amt,auto_cashout:auto})){
bal-=amt;
bet_cur={amount:amt,auto:auto};
upBal();
$('betBtn').disabled=true;
notif('–°—Ç–∞–≤–∫–∞ '+amt+'‚ÇΩ –ø—Ä–∏–Ω—è—Ç–∞','success');
}
}

function cash(){
if(bet_cur&&send({type:'cashout',player_id:pid})){
$('cashBtn').disabled=true;
}
}

function adj(mult){
const v=parseFloat($('amt').value)||100;
$('amt').value=Math.max(10,Math.min(10000,Math.floor(v*mult)));
}

function upStatus(status){
const txt={betting:'–ü—Ä–∏–µ–º —Å—Ç–∞–≤–æ–∫',flying:'–ü–æ–ª–µ—Ç!',crashed:'–ö—Ä–∞—à!'};
$('s').textContent='üéØ '+txt[status]||status;
if(status==='betting'){
$('betBtn').classList.remove('hidden');
$('cashBtn').classList.add('hidden');
$('betBtn').disabled=false;
$('cashBtn').disabled=false;
reset();
}
}

function showCD(sec){
const cd=$('c');
cd.textContent=sec;
cd.classList.remove('hidden');
$('g').classList.add('countdown-active');
}

function startFly(){
$('c').classList.add('hidden');
$('g').classList.remove('countdown-active');
$('g').classList.add('flying');
if(bet_cur){
$('betBtn').classList.add('hidden');
$('cashBtn').classList.remove('hidden');
}
}

function upMult(val){
$('m').textContent=val.toFixed(2)+'x';
}

function reset(){
const gEl=$('g');
gEl.classList.remove('flying','crashed','countdown-active');
$('m').textContent='1.00x';
$('b').innerHTML='';
const o=gEl.querySelector('.crash-overlay');
if(o)o.remove();
}

function upHist(h){
hist=h;
$('h').innerHTML=h.map(v=>{
let cls='h-low';
if(v>=2)cls='h-mid';
if(v>=5)cls='h-high';
return '<div class="h-item '+cls+'">'+v.toFixed(2)+'x</div>';
}).join('');
}

function addBet(d){
const div=document.createElement('div');
div.className='bet-item';
div.id='bet-'+d.player_id;
div.textContent=d.amount+'‚ÇΩ'+(d.auto_cashout?' @'+d.auto_cashout+'x':'');
$('b').appendChild(div);
}

function handleCash(d){
if(d.player_id===pid){
bal+=d.win;
upBal();
bet_cur=null;
$('cashBtn').classList.add('hidden');
notif('üí∞ '+d.win.toFixed(2)+'‚ÇΩ (√ó'+d.multiplier+')','success');
}
const bt=$('bet-'+d.player_id);
if(bt){
bt.classList.add('bet-win');
bt.textContent+=' ‚úì';
}
}

function handleCrash(d){
const gEl=$('g');
gEl.classList.remove('flying');
gEl.classList.add('crashed');
const o=document.createElement('div');
o.className='crash-overlay';
o.textContent='üí• '+d.crash_point+'x';
gEl.appendChild(o);
if(bet_cur){
notif('–ö—Ä–∞—à –Ω–∞ '+d.crash_point+'x','error');
bet_cur=null;
}
upHist([d.crash_point].concat(hist).slice(0,15));
setTimeout(()=>$('cashBtn').classList.add('hidden'),1500);
}

function upBal(){
$('bal').textContent=bal.toFixed(0)+'‚ÇΩ';
}

if(document.readyState==='loading'){
document.addEventListener('DOMContentLoaded',init);
}else{init()}

window.addEventListener('beforeunload',()=>{if(ws)ws.close()});
})();
</script>
</body>
</html>
