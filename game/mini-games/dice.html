<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>–ö–æ—Å—Ç–∏: –ö—Ç–æ –≤—ã—à–µ? üé≤</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <link rel="stylesheet" href="shared/tg-style.css">
  <script src="shared/firebase.js"></script>
  <script src="dice.js" defer></script>
  <style>
    .screen{display:none;min-height:100vh}.screen.active{display:block}
    .btn{height:52px;border-radius:12px;padding:0 20px;font-size:17px;font-weight:600;border:none;cursor:pointer;background:var(--tg-theme-button-color,#2481cc);color:var(--tg-theme-button-text-color,#fff)}
    .btn:disabled{opacity:0.6;cursor:not-allowed}
    .rolling{animation:roll 1s cubic-bezier(.25,.46,.45,.94) infinite}
    @keyframes roll{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
    .dice-large{font-size:96px}
    .room-item{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;background:var(--tg-theme-bg-color,#fff);border-radius:12px;margin-bottom:8px}
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>–ö–æ—Å—Ç–∏: –ö—Ç–æ –≤—ã—à–µ?</h1>
      <div class="balance">–ë–∞–ª–∞–Ω—Å: <span id="balance">‚Äî</span> üí∞</div>
    </div>

    <!-- –ú–µ–Ω—é -->
    <div id="menu" class="screen active">
      <input type="number" id="betAmount" placeholder="–°—Ç–∞–≤–∫–∞ –æ—Ç 10" min="10" value="50" style="width:100%;padding:16px;margin-bottom:12px;border-radius:12px;border:none;background:var(--tg-theme-secondary-bg-color)">
      <button id="createGame" class="btn" style="width:100%;margin-bottom:20px">–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
      <input type="text" id="roomCode" placeholder="–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã" maxlength="6" style="text-transform:uppercase;width:100%;padding:16px;margin-bottom:12px;border-radius:12px;border:none;background:var(--tg-theme-secondary-bg-color)">
      <button id="joinGame" class="btn" style="width:100%;margin-bottom:20px">–í–æ–π—Ç–∏ –ø–æ –∫–æ–¥—É</button>
      <div id="roomsList"></div>
    </div>

    <!-- –û–∂–∏–¥–∞–Ω–∏–µ -->
    <div id="waiting" class="screen">
      <div style="text-align:center;padding-top:100px">
        <h2>–ö–æ–º–Ω–∞—Ç–∞ <strong id="roomIdDisplay"></strong></h2>
        <div class="dice-large rolling">üé≤</div>
        <p>–û–∂–∏–¥–∞–µ–º –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞...</p>
        <button id="cancelRoom" class="btn">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>

    <!-- –ò–≥—Ä–∞ -->
    <div id="game" class="screen">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:30px">
        <div style="text-align:center">
          <img id="myAvatar" src="" width="80" height="80" style="border-radius:50%;border:3px solid #2481cc">
          <div id="mypName"></div>
        </div>
        <div style="font-size:28px;font-weight:bold">VS</div>
        <div style="text-align:center">
          <img id="oppAvatar" src="" width="80" height="80" style="border-radius:50%;border:3px solid #666">
          <div id="oppName"></div>
        </div>
      </div>
      <div style="text-align:center;font-size:18px;margin-bottom:30px">–°—Ç–∞–≤–∫–∞: <strong id="gameBet"></strong> üí∞</div>
      <div style="display:flex;justify-content:space-around;margin:40px 0">
        <div style="text-align:center">
          <div id="yourDice" class="dice-large">üé≤</div>
          <div id="yourResult" style="font-size:48px;margin-top:10px">-</div>
        </div>
        <div style="text-align:center">
          <div id="opponentDice" class="dice-large">üé≤</div>
          <div id="opponentResult" style="font-size:48px;margin-top:10px">-</div>
        </div>
      </div>
      <button id="rollBtn" class="btn" style="width:100%">–ë—Ä–æ—Å–∏—Ç—å –∫–æ—Å—Ç–∏!</button>
      <button id="leaveGame" class="btn" style="margin-top:12px;background:#666">–ü–æ–∫–∏–Ω—É—Ç—å</button>
    </div>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç -->
    <div id="result" class="screen">
      <div style="text-align:center;padding-top:100px">
        <h1 id="resultText"></h1>
        <div style="font-size:48px;margin:30px 0" id="winAmount"></div>
        <button id="playAgain" class="btn">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
      </div>
    </div>
  </div>
</body>
</html>