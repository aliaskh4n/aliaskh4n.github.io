# GIS технологии

Современная платформа для публикации статей о ГИС-технологиях и обмена знаниями с использованием Flask и SQLite.

## Содержание

- [Обзор проекта](#обзор-проекта)
- [Функциональность](#функциональность)
- [Технологии](#технологии)
- [Установка и запуск](#установка-и-запуск)
- [Работа с редактором статей](#работа-с-редактором-статей)
- [Структура проекта](#структура-проекта)
- [Особенности разработки](#особенности-разработки)
- [Планы развития](#планы-развития)

## Обзор проекта

Этот проект представляет собой полнофункциональный блог о ГИС-технологиях, разработанный на веб-фреймворке Flask с использованием шаблонизатора Jinja2. Он позволяет пользователям регистрироваться, публиковать статьи с поддержкой Markdown и изображений, редактировать и удалять их, просматривать статьи других пользователей.

### Архитектура проекта

Блог построен на основе архитектуры MVC (Model-View-Controller):

- **Model**: Определяет структуру данных и бизнес-логику приложения
  - SQLAlchemy ORM модели для Пользователей и Статей
  - Методы для работы с данными и валидации

- **View**: Отвечает за отображение данных пользователю
  - Jinja2 шаблоны для генерации HTML
  - CSS для стилизации и создания адаптивного интерфейса
  - JavaScript для интерактивных элементов

- **Controller**: Обрабатывает запросы и управляет потоком данных
  - Flask-маршруты для разных URL-путей
  - Обработчики форм и загрузки данных
  - Логика авторизации и аутентификации

### Основные возможности

Платформа предназначена для создания и обмена статьями о ГИС-технологиях, геоинформационных системах, пространственном анализе и смежных областях. Удобный Markdown-редактор с предпросмотром в реальном времени позволяет создавать хорошо структурированные статьи с поддержкой изображений, что особенно важно для визуализации географических данных.

## Функциональность

- **Аутентификация и авторизация**:
  - Регистрация новых пользователей
  - Вход в систему
  - Защита контента (редактирование/удаление только своих статей)

- **Управление статьями**:
  - Создание новых статей с использованием Markdown-редактора
  - Добавление изображений в статьи
  - Редактирование существующих статей
  - Удаление статей
  - Просмотр статей с поддержкой Markdown-форматирования

- **Дополнительные возможности**:
  - Полнотекстовый поиск статей
  - Профили пользователей
  - Адаптивный дизайн (мобильные устройства)
  - Система уведомлений (flash-сообщения)

## Технологии

### Backend
- **Python 3.x**: Основной язык программирования
- **Flask**: Легковесный веб-фреймворк для Python
  - **flask-sqlalchemy**: Расширение для работы с базами данных через SQLAlchemy ORM
  - **werkzeug.security**: Модуль для безопасной работы с паролями (хеширование, проверка)
  - **flask.session**: Управление пользовательскими сессиями

### База данных
- **SQLite**: Легкая встраиваемая реляционная база данных
- **SQLAlchemy ORM**: Объектно-реляционное отображение для работы с базой данных через Python-объекты
- **Миграции**: Автоматическое создание таблиц при первом запуске

### Frontend
- **HTML5**: Структура и разметка страниц
- **CSS3**: Стилизация веб-интерфейса с использованием современных возможностей
  - Адаптивный дизайн (Flexbox, Grid)
  - Переменные CSS (Custom Properties) для управления темой
  - Анимации и переходы
- **JavaScript (ES6+)**: Интерактивность на стороне клиента
  - **marked.js**: Библиотека для парсинга Markdown в HTML
  - Динамический предпросмотр редактора
  - Обработка форм и валидация

### Шаблонизация
- **Jinja2**: Шаблонизатор, интегрированный с Flask
  - Наследование шаблонов (base.html)
  - Включения и макросы
  - Условное отображение контента

### Система безопасности
- **CSRF-защита**: Встроенная в Flask защита от межсайтовой подделки запросов
- **Хеширование паролей**: Использование Werkzeug для безопасного хранения паролей
- **Проверка авторизации**: Контроль доступа к редактированию и удалению статей

### Инструменты разработки
- **Flask Debug Toolbar**: Отладочная панель для разработки
- **Flask-DebugMode**: Автоматическая перезагрузка при изменении кода
- **SQLite Browser**: Инструмент для просмотра и редактирования базы данных

## Установка и запуск

1. Клонируйте репозиторий:
```bash
git clone https://github.com/username/gis-technologies.git
cd gis-technologies
```

2. Создайте виртуальное окружение и активируйте его:
```bash
python -m venv venv
source venv/bin/activate  # На Windows: venv\Scripts\activate
```

3. Установите зависимости:
```bash
pip install flask flask-sqlalchemy
```

4. Запустите приложение:
```bash
python app.py
```

5. Откройте браузер и перейдите по адресу: `http://127.0.0.1:5000/`

## Работа с редактором статей

В проекте реализован Markdown-редактор для создания и редактирования статей. Markdown — это легкий язык разметки, который позволяет форматировать текст без использования HTML.

### Основные функции редактора:

1. **Визуальный редактор**: При наведении курсора или фокусе на текстовом поле показывается предпросмотр форматированного текста.
2. **Панель инструментов**: В нижней части экрана есть кнопки для быстрого форматирования.

### Использование Markdown в редакторе:

- **Заголовки**:
  ```
  # Заголовок первого уровня
  ## Заголовок второго уровня
  ```

- **Форматирование текста**:
  ```
  **Жирный текст**
  *Курсивный текст*
  ```

- **Ссылки**:
  ```
  [Текст ссылки](http://example.com)
  ```

- **Параграфы**: Разделяйте абзацы двойным переносом строки:
  ```
  Первый абзац.

  Второй абзац.
  ```

- **Изображения**: Вставляйте изображения в следующем формате:
  ```
  ![Альтернативный текст](URL_изображения)
  ```
  Например:
  ```
  ![Карта ГИС](https://example.com/gis-map.jpg)
  ```

### Работа с изображениями:

1. Загрузите изображение на внешний хостинг (например, Imgur, Cloudinary)
2. Скопируйте URL изображения
3. Вставьте изображение в статью, используя синтаксис Markdown для изображений

### Советы по использованию редактора:

- Используйте кнопки на панели инструментов для быстрого добавления форматирования.
- Можно выделить текст и нажать кнопку форматирования, чтобы применить стиль к выделенному тексту.
- Предпросмотр обновляется автоматически при вводе текста, для его просмотра просто наведите курсор на текстовое поле.
- Для включения изображений в статьи сначала загрузите их на внешний сервис, затем добавьте ссылку в формате Markdown.
- Оптимальный размер изображений не должен превышать 1200px по ширине для лучшего отображения на разных устройствах.

## Структура проекта

### Организация файлов

```
gis/
├── app.py                 # Основной файл приложения
├── static/                # Статические файлы
│   ├── styles.css         # Основные стили приложения
│   ├── js/                # JavaScript файлы (если добавятся)
│   └── img/               # Изображения для интерфейса
├── templates/             # HTML шаблоны
│   ├── base.html          # Базовый шаблон с общей структурой
│   ├── home.html          # Главная страница блога
│   ├── article.html       # Страница отдельной статьи
│   ├── create_article.html # Форма создания статьи
│   ├── edit_article.html  # Форма редактирования статьи
│   ├── register.html      # Форма регистрации
│   ├── login.html         # Форма входа
│   ├── profile.html       # Профиль пользователя
│   ├── search.html        # Результаты поиска
│   ├── index.html         # Редактор Markdown
│   └── view.html          # Просмотр статьи
├── instance/              # Экземпляр приложения (автоматически создаётся)
│   └── blog.db            # База данных SQLite
```

### Детали реализации

#### Модели данных (app.py)

1. **User** - модель пользователя:
   - id: уникальный идентификатор
   - username: имя пользователя (уникальное)
   - email: email пользователя (уникальный)
   - password_hash: хеш пароля
   - articles: отношение один-ко-многим со статьями

2. **Article** - модель статьи:
   - id: уникальный идентификатор
   - title: заголовок статьи
   - content: содержимое статьи (Markdown-формат)
   - date_posted: дата публикации
   - user_id: идентификатор автора (внешний ключ)

#### Маршруты (app.py)

- `/`: Главная страница со списком статей
- `/register`: Регистрация нового пользователя
- `/login`: Вход в систему
- `/logout`: Выход из системы
- `/create`: Создание новой статьи
- `/article/<id>`: Просмотр статьи
- `/edit/<id>`: Редактирование статьи
- `/delete/<id>`: Удаление статьи
- `/search`: Поиск статей
- `/profile/<username>`: Профиль пользователя
- `/index`: Редактор Markdown

#### Интерфейс

- **Тёмная тема**: Современный интерфейс с использованием тёмных цветов для комфортной работы
- **Адаптивный дизайн**: Корректное отображение на мобильных устройствах и планшетах
- **Markdown-редактор**: Поддержка Markdown с живым предпросмотром
- **Flash-сообщения**: Информационные сообщения о результатах действий

## Особенности разработки

### Обработка Markdown

Проект использует библиотеку marked.js для преобразования Markdown в HTML. Процесс выглядит следующим образом:

1. Пользователь вводит текст в формате Markdown в редакторе
2. JavaScript-функция `updatePreview()` преобразует введенный текст в HTML для предпросмотра
3. При сохранении статьи текст в формате Markdown сохраняется в базе данных
4. При отображении статьи, Markdown преобразуется в HTML для отображения пользователю

Для парсинга сложных элементов, таких как изображения и ссылки, используются регулярные выражения:

```javascript
// Пример преобразования Markdown в HTML (упрощенная версия из index.html)
function updatePreview() {
    let text = input.value;
    let html = '';
    
    // Разбиваем на абзацы
    const paragraphs = text.split('\n\n');
    
    for (let p of paragraphs) {
        if (p.trim()) {
            // Жирный текст
            processed = p.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            
            // Курсив
            processed = processed.replace(/\*(.*?)\*/g, '<em>$1</em>');
            
            // Ссылки
            processed = processed.replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2">$1</a>');
            
            // Изображения (дополнительно)
            processed = processed.replace(/!\[(.*?)\]\((.*?)\)/g, '<img src="$2" alt="$1">');
            
            // Заголовки и параграфы
            // ...
        }
    }
    
    preview.innerHTML = html;
}
```

### Система аутентификации

Для обеспечения безопасности пароли не хранятся в открытом виде. Вместо этого:

1. При регистрации пароль хешируется с использованием `werkzeug.security.generate_password_hash`
2. При входе пароль проверяется с использованием `werkzeug.security.check_password_hash`
3. Аутентифицированные пользователи получают сессию, которая сохраняется в cookie

### Оптимизация базы данных

Для повышения производительности при работе с большим количеством статей:

1. Используется ленивая загрузка (lazy loading) для связей между таблицами
2. Индексы на часто используемых полях (username, email, title)
3. Каскадное удаление связанных записей при удалении пользователя

## Планы развития

### Краткосрочные планы

1. **Загрузка изображений**: Добавление возможности загружать изображения напрямую на сервер
2. **Комментарии к статьям**: Система комментирования для обсуждения статей
3. **Теги и категории**: Добавление системы тегов для лучшей организации статей

### Среднесрочные планы

1. **Расширенный редактор**: Добавление поддержки таблиц, кода и других элементов Markdown
2. **Социальные функции**: Лайки, подписки на авторов, уведомления
3. **API**: Разработка API для интеграции с другими сервисами

### Долгосрочные планы

1. **Многоязычность**: Поддержка нескольких языков интерфейса
2. **Расширенная аналитика**: Статистика просмотров, популярности статей
3. **Мобильное приложение**: Разработка нативного мобильного приложения

## Лицензия

Этот проект лицензирован под MIT License - см. файл LICENSE для деталей.
